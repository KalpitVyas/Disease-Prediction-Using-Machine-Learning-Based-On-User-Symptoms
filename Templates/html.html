<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Welcome!</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<!-- Latest compiled and minified CSS -->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
		<!-- jQuery library -->
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
		<!-- Latest compiled JavaScript -->
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
		<link href="LoginUserCss.css" rel = "stylesheet" type="text/css">
	</head>
<body>
	<!--https://github.com/firebase/firebase-js-sdk/issues/998-->
		<!-- The core Firebase JS SDK is always required and must be listed first -->
<script src="https://www.gstatic.com/firebasejs/8.1.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.1.1/firebase-auth.js"></script>
	<!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->
<script src="https://www.gstatic.com/firebasejs/8.1.1/firebase-analytics.js"></script>
	<script>
	var firebaseConfig = {
    apiKey: "AIzaSyAhTzPkUDYPkQCRxAhDAGR8BGIMuHMs9z4",
    authDomain: "sympchecker-42e0e.firebaseapp.com",
    databaseURL: "https://sympchecker-42e0e.firebaseio.com",
    projectId: "sympchecker-42e0e",
    storageBucket: "sympchecker-42e0e.appspot.com",
    messagingSenderId: "182815287710",
    appId: "1:182815287710:web:fcdcd7a744c223629b0e8f",
    measurementId: "G-PNGPTWGDBK"
  };
  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  firebase.analytics();
	</script>
	<div class = "container" style="margin-left: 30%; margin-top: 12%; border:2px solid; border-radius: 5px; width: 40%; height: 390px;">
		<div style = "padding-left: 27%; padding-top: 5%;">
			<input type = "email" id = "email" placeholder="Enter Email Address" class="input"><br><br>
			<input type = "password" id = "password" placeholder="Enter Password" class = "input"><br><br>
			<button onclick="Login()" type = "button" class = "btn btn-success" style = "width: 30%;" >Login</button>
			<button onclick = "SignUp()" class = "btn btn-primary" style = "width: 30%;">Create Account</button><br><br>
			<buton type = "button" class = "btn btn-danger" style = "margin-left: 14.5%;" onclick = "ForgotPassword()">Forgot Password</buton>
		</div>
		<hr><br>
		<button onclick="GoogleAccount()" type ="button" class = "btn btn-secondary" style="width: 50%; margin-left: 25%;"><img src = "icons8-google-48.png">Login With Google</button>
	</div>
<script>
var auth = firebase.auth();
function Login(){
	var email = document.getElementById("email");
	  var password = document.getElementById("password");
	  const promise = auth.signInWithEmailAndPassword(email.value,password.value);
	  promise.catch(e => alert(e.message));
		var Email = email.value;
	 alert("Login Successfull for " + Email);
}
function SignUp(){
	console.log("Hey");
	const email = document.getElementById("email");
	  const password = document.getElementById("password");
	  const promise = auth.createUserWithEmailAndPassword(email.value,password.value);
	  promise.catch(e => alert(e.message));
		const Email = email.value;
	  alert("Accout Creation Successfull " + Email);
}
function SignOut(){
	auth.signOut();
	then(()=>{
		alert("You have been signed out successfully");
	})
	.catch(error => {
		console.log(error);
	})
}
function ForgotPassword(){
	//console.log("Hey");
	const GetEmail = document.getElementById("ResetEmail");
	const Reset = GetEmail.value;
	firebase.auth().sendPasswordResetEmail(Reset);
	then(()=> {
		console.log("Password Reset Link Sent Successfully");
	})
	.catch(error => {
		console.log(error);
		console.log("User Not Registered....")
		alert("Reset Password Failed, User Not Registered.");
	})
}
auth.onAuthStateChanged(function(user){
	if(user){
		//If the user is already logged in the it will be redirected to the specified URL.
		const URL = "http://127.0.0.1:5000/";
		//const Load = "\Users\sanja\Desktop\Final Year Project\Home.html";
		//const GET = URl.value;
		const win = window.open(URL, "_blank");
	}
	else{
		// When no user is Logged-in then Else part of this code will be executed.
	}
})
function GoogleAccount(){
	console.log("Google Authentication Started");
	var provider = new firebase.auth.GoogleAuthProvider();
	firebase.auth().signInWithPopup(provider).then(function(result) {
  // This gives you a Google Access Token. You can use it to access the Google API.
  var token = result.credential.accessToken;
  // The signed-in user info.
  var user = result.user;
  // ...
}).catch(function(error) {
  // Handle Errors here.
  var errorCode = error.code;
  var errorMessage = error.message;
  // The email of the user's account used.
  var email = error.email;
  // The firebase.auth.AuthCredential type that was used.
  var credential = error.credential;
  // ...
});
}

	</script>
</body>
</html>
